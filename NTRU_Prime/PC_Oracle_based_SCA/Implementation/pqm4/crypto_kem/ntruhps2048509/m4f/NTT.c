#include "NTT.h"

const int root_table[248] = {191052, -311503, 207751, 468028, -149945, 114478, -82425, -489046, 78830, 78830, 191052, 78830, 191052, -311503, 207751, 78830, 191052, -311503, 207751, 468028, -149945, 114478, -82425, 191052, -311503, 207751, 468028, -149945, 114478, -82425, 254425, -83285, -205022, 318314, 365552, -403894, 235060, 449706, -311503, 468028, -149945, 254425, -83285, -205022, 318314, 378933, 313241, -397250, 288321, 74768, 22897, 129870, -461967, 207751, 114478, -82425, 365552, -403894, 235060, 449706, -35962, 370478, 232373, 159337, 405929, 59399, -40385, 317168, 468028, 254425, -83285, 378933, 313241, -397250, 288321, 13867, 21742, 486841, -73546, 7056, -391031, -493755, -78001, -149945, -205022, 318314, 74768, 22897, 129870, -461967, -495107, 279814, -363890, -182676, -207660, 75978, 187423, -78196, 114478, 365552, -403894, -35962, 370478, 232373, 159337, 507011, 331715, 297886, -346620, -299045, 275767, -51317, 402791, -82425, 235060, 449706, 405929, 59399, -40385, 317168, -272172, -375619, 376740, -409013, -42578, -405086, 81030, -422078, 254425, 378933, 313241, 13867, 21742, 486841, -73546, 487892, -428144, -43370, -393153, 248256, -228921, -29446, -59870, -83285, -397250, 288321, 7056, -391031, -493755, -78001, 285179, 257414, -147526, 390544, -275430, -160445, -436582, 316768, -205022, 74768, 22897, -495107, 279814, -363890, -182676, 27120, -345344, -470298, -498651, -358783, 477219, 133279, -401288, 318314, 129870, -461967, -207660, 75978, 187423, -78196, 288431, -155391, -18223, -478095, -347554, 256625, -153141, -298605, 365552, -35962, 370478, 507011, 331715, 297886, -346620, -367175, -334857, 42298, -465942, 329620, -89230, -288348, 279364, -403894, 232373, 159337, -299045, 275767, -51317, 402791, 268720, 464538, 356621, 343605, 476116, 44548, 347463, 399863, 235060, 405929, 59399, -272172, -375619, 376740, -409013, -188449, -309697, -118699, 418878, -284025, 170731, 515076, 290607, 449706, -40385, 317168, -42578, -405086, 81030, -422078, 445216, 114673, 1019, -364661, -179242, -317922, -202373, 400989};
const int root_table_inv[254] = {78830, 78830, -191052, 78830, -191052, -207751, 311503, -191052, -207751, 311503, 82425, -114478, 149945, -468028, -207751, 82425, -114478, -449706, -235060, 403894, -365552, 311503, 149945, -468028, -318314, 205022, 83285, -254425, 82425, -449706, -235060, -317168, 40385, -59399, -405929, -114478, 403894, -365552, -159337, -232373, -370478, 35962, 149945, -318314, 205022, 461967, -129870, -22897, -74768, -468028, 83285, -254425, -288321, 397250, -313241, -378933, -449706, -317168, 40385, 422078, -81030, 405086, 42578, -235060, -59399, -405929, 409013, -376740, 375619, 272172, 403894, -159337, -232373, -402791, 51317, -275767, 299045, -365552, -370478, 35962, 346620, -297886, -331715, -507011, -318314, 461967, -129870, 78196, -187423, -75978, 207660, 205022, -22897, -74768, 182676, 363890, -279814, 495107, 83285, -288321, 397250, 78001, 493755, 391031, -7056, -254425, -313241, -378933, 73546, -486841, -21742, -13867, -317168, 422078, -81030, -400989, 202373, 317922, 179242, 40385, 405086, 42578, 364661, -1019, -114673, -445216, -59399, 409013, -376740, -290607, -515076, -170731, 284025, -405929, 375619, 272172, -418878, 118699, 309697, 188449, -159337, -402791, 51317, -399863, -347463, -44548, -476116, -232373, -275767, 299045, -343605, -356621, -464538, -268720, -370478, 346620, -297886, -279364, 288348, 89230, -329620, 35962, -331715, -507011, 465942, -42298, 334857, 367175, 461967, 78196, -187423, 298605, 153141, -256625, 347554, -129870, -75978, 207660, 478095, 18223, 155391, -288431, -22897, 182676, 363890, 401288, -133279, -477219, 358783, -74768, -279814, 495107, 498651, 470298, 345344, -27120, -288321, 78001, 493755, -316768, 436582, 160445, 275430, 397250, 391031, -7056, -390544, 147526, -257414, -285179, -313241, 73546, -486841, 59870, 29446, 228921, -248256, -378933, -21742, -13867, 393153, 43370, 428144, -487892, 78830, 78830, -191052, 78830, -191052, -207751, 311503, -191052, -207751, 311503, 82425, -114478, 149945, -468028, -207751, 82425, -114478, -449706, -235060, 403894, -365552, 311503, 149945, -468028, -318314, 205022, 83285, -254425, -191052, -14494};
const int mul_table[128] = {78830, 191052, -311503, 207751, 468028, -149945, 114478, -82425, 254425, -83285, -205022, 318314, 365552, -403894, 235060, 449706, 378933, 313241, -397250, 288321, 74768, 22897, 129870, -461967, -35962, 370478, 232373, 159337, 405929, 59399, -40385, 317168, 13867, 21742, 486841, -73546, 7056, -391031, -493755, -78001, -495107, 279814, -363890, -182676, -207660, 75978, 187423, -78196, 507011, 331715, 297886, -346620, -299045, 275767, -51317, 402791, -272172, -375619, 376740, -409013, -42578, -405086, 81030, -422078, 487892, -428144, -43370, -393153, 248256, -228921, -29446, -59870, 285179, 257414, -147526, 390544, -275430, -160445, -436582, 316768, 27120, -345344, -470298, -498651, -358783, 477219, 133279, -401288, 288431, -155391, -18223, -478095, -347554, 256625, -153141, -298605, -367175, -334857, 42298, -465942, 329620, -89230, -288348, 279364, 268720, 464538, 356621, 343605, 476116, 44548, 347463, 399863, -188449, -309697, -118699, 418878, -284025, 170731, 515076, 290607, 445216, 114673, 1019, -364661, -179242, -317922, -202373, 400989};

extern void NTT_1024(const unsigned short *big_coeffs, const int *_root_table, int _MOD, int _Mprime,
    const unsigned short *small_coeffs, const int *_mul_table, unsigned short *res_coeffs, const int *_root_table_inv);
void mul_509(unsigned short *res_coeffs, const unsigned short *small_coeffs, const unsigned short *big_coeffs)
{
    NTT_1024(&big_coeffs[0], root_table, MOD, Mprime,
        &small_coeffs[0], mul_table, &res_coeffs[0], root_table_inv);
}
